<!DOCTYPE html>
<html>
<head>
    <title>Joy-Con Rumble Controller</title>
    <script>
        function startRumble() {
            const gamepads = navigator.getGamepads();
            const leftJoyCon = gamepads.find(gamepad => gamepad && gamepad.id.includes("(L)"));
            const rightJoyCon = gamepads.find(gamepad => gamepad && gamepad.id.includes("(R)"));

            if (leftJoyCon && leftJoyCon.vibrationActuator) {
                leftJoyCon.vibrationActuator.playEffect("dual-rumble", {
                    startDelay: 0,
                    duration: 500,
                    strongMagnitude: 1.0,
                    weakMagnitude: 1.0
                });
                console.log(`Rumble started on Left Joy-Con`);
            }

            setTimeout(() => {
                if (rightJoyCon && rightJoyCon.vibrationActuator) {
                    rightJoyCon.vibrationActuator.playEffect("dual-rumble", {
                        startDelay: 0,
                        duration: 500,
                        strongMagnitude: 1.0,
                        weakMagnitude: 1.0
                    });
                    console.log(`Rumble started on Right Joy-Con`);
                }
            }, 600); // Delayed pulse to right Joy-Con after left Joy-Con finishes
        }

        function stopRumble() {
            const gamepads = navigator.getGamepads();
            for (const gamepad of gamepads) {
                if (gamepad && gamepad.vibrationActuator) {
                    gamepad.vibrationActuator.playEffect("dual-rumble", {
                        startDelay: 0,
                        duration: 0,
                        strongMagnitude: 0,
                        weakMagnitude: 0
                    });
                    console.log(`Rumble stopped on ${gamepad.id}`);
                }
            }
        }

        window.addEventListener("gamepadconnected", (event) => {
            console.log("Gamepad connected: ", event.gamepad);
            alert(`Gamepad connected: ${event.gamepad.id}`);
        });

        window.addEventListener("gamepaddisconnected", (event) => {
            console.log("Gamepad disconnected: ", event.gamepad);
            alert(`Gamepad disconnected: ${event.gamepad.id}`);
        });

        function pollGamepadInput() {
            const gamepads = navigator.getGamepads();
            for (const gamepad of gamepads) {
                if (gamepad) {
                    console.log(`Gamepad ${gamepad.index}: ${gamepad.id}`);
                }
            }
            requestAnimationFrame(pollGamepadInput);
        }

        window.addEventListener("gamepadconnected", pollGamepadInput);
    </script>
</head>
<body>
    <h1>Joy-Con Rumble Controller</h1>
    <button onclick="startRumble()">Start Rumble</button>
    <button onclick="stopRumble()">Stop Rumble</button>
</body>
</html>

